syntax = "proto3";

package edge.agent.updater.services.v1;

import "edge/agent/services/v1/shared.proto";

service EdgeAgentUpdateService {
    rpc UpdateAgent(stream UpdateAgentRequest) returns (stream UpdateAgentResponse);
}

message UpdateAgentRequest {
    oneof request_type {
        Chunk chunk = 1;
        ControlCommand control = 2;
    }

    message Chunk {
        bytes data = 1;
    }

    message ControlCommand {
        oneof command {
            // Triggers the replacement of the running agent with the new binary.
            Update update = 1;
        }

        message Update {
            
        }
    }
}

message UpdateAgentResponse {
    oneof response_type {
        Updated updated = 1;
    }

    message Updated {
        
    }
}